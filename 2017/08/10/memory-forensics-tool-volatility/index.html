<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />








  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>




  <meta name="author" content="restran" />





  <link rel="alternate" href="/atom.xml" title="淡水网志" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="volatility 是一款内存取证和分析工具，可以对 Procdump 等工具 dump 出来的内存进行分析，并提取内存中的文件。该工具支持 Windows 和 Linux，Kali 下面默认已经安装。 volatility 的许多功能由其内置的各种插件来实现，例如查看当前的网络连接，命令行中的命令，记事本中的内容等等。 命令格式 volatility [plugin] -f [image] -">
<meta name="keywords" content="CTF,取证分析,内存取证">
<meta property="og:type" content="article">
<meta property="og:title" content="内存取证工具 volatility 使用说明">
<meta property="og:url" content="http://www.restran.net/2017/08/10/memory-forensics-tool-volatility/index.html">
<meta property="og:site_name" content="淡水网志">
<meta property="og:description" content="volatility 是一款内存取证和分析工具，可以对 Procdump 等工具 dump 出来的内存进行分析，并提取内存中的文件。该工具支持 Windows 和 Linux，Kali 下面默认已经安装。 volatility 的许多功能由其内置的各种插件来实现，例如查看当前的网络连接，命令行中的命令，记事本中的内容等等。 命令格式 volatility [plugin] -f [image] -">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-08-10T00:41:42.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="内存取证工具 volatility 使用说明">
<meta name="twitter:description" content="volatility 是一款内存取证和分析工具，可以对 Procdump 等工具 dump 出来的内存进行分析，并提取内存中的文件。该工具支持 Windows 和 Linux，Kali 下面默认已经安装。 volatility 的许多功能由其内置的各种插件来实现，例如查看当前的网络连接，命令行中的命令，记事本中的内容等等。 命令格式 volatility [plugin] -f [image] -">

<script src="/vendors/pace/pace.min.js"></script>
<link href="/vendors/pace/themes/red/pace-theme-minimal.css" rel="stylesheet" />


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: ''
  };
</script>



  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-38277310-2', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a060ea3ffa16e451223f396f226de9c7";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <title> 内存取证工具 volatility 使用说明 | 淡水网志 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  
    
  

  <div class="container one-column page-post-detail">
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner "><h1 class="site-meta">
  <!-- <span class="logo-line-before"><i></i></span> -->
  <a href="/" class="brand" rel="start">
      <span class="logo" style="background-image:url(/uploads/avatar.jpg)">
      </span>
      <span class="site-title">淡水网志</span>
  </a>
  <!-- <span class="logo-line-after"><i></i></span> -->
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-portfolio">
          <a href="/portfolio" rel="section">
            <i class="menu-item-icon icon-next-portfolio"></i> <br />
            作品集
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            <i class="menu-item-icon icon-next-about"></i> <br />
            关于
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      
  


      <div class="main-inner">

        <div id="content" class="content ">
          

  <div id="posts" class="posts-expand">
   
    
  
  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              内存取证工具 volatility 使用说明
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
         <!--  发表于 -->
          <time itemprop="dateCreated" datetime="2017-08-10T00:00:00+08:00" content="2017-08-10">
            2017-08-10
          </time>
        </span>

        <span class="post-content-count">&nbsp; | &nbsp; 2,566字</span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/CTF/" itemprop="url" rel="index">
                  <span itemprop="name">CTF</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          &nbsp; | &nbsp;
          <span id="/2017/08/10/memory-forensics-tool-volatility/"class="leancloud_visitors" data-flag-title="内存取证工具 volatility 使用说明">
                   &nbsp;阅读
                  </span>
        
        
        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2017/08/10/memory-forensics-tool-volatility/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/08/10/memory-forensics-tool-volatility/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><p><a href="https://github.com/volatilityfoundation/volatility" target="_blank" rel="noopener">volatility</a> 是一款内存取证和分析工具，可以对 Procdump 等工具 dump 出来的内存进行分析，并提取内存中的文件。该工具支持 Windows 和 Linux，Kali 下面默认已经安装。</p>
<p>volatility 的许多功能由其内置的各种插件来实现，例如查看当前的网络连接，命令行中的命令，记事本中的内容等等。</p>
<p>命令格式</p>
<pre><code>volatility [plugin] -f [image] --profile=[profile] 
</code></pre><p>在分析之前，需要先判断当前的镜像信息，分析出是哪个操作系统</p>
<pre><code>volatility imageinfo -f file.raw
</code></pre><p>知道镜像后，就可以在 –profile 中带上对应的操作系统</p>
<h2 id="常见的插件"><a href="#常见的插件" class="headerlink" title="常见的插件"></a>常见的插件</h2><p>查看当前展示的 notepad 文本</p>
<pre><code>volatility notepad -f file.raw --profile=WinXPSP2x86
</code></pre><p>查看当前操作系统中的 password hash，例如 Windows 的 SAM 文件内容</p>
<pre><code>volatility hashdump -f file.raw --profile=WinXPSP2x86
</code></pre><p>查看所有进程</p>
<pre><code>volatility psscan -f file.raw --profile=WinXPSP2x86
</code></pre><p>扫描所有的文件列表</p>
<pre><code>volatility filescan -f file.raw --profile=WinXPSP2x86
</code></pre><p>扫描 Windows 的服务</p>
<pre><code>volatility svcscan -f file.raw --profile=WinXPSP2x86
</code></pre><p>查看网络连接</p>
<pre><code>volatility connscan -f file.raw --profile=WinXPSP2x86
</code></pre><p>查看命令行上的操作</p>
<pre><code>volatility cmdscan -f file.raw --profile=WinXPSP2x86
</code></pre><p>根据进程的 pid dump出指定进程到指定的文件夹dump_dir</p>
<pre><code>volatility memdump -p 120 -f file.raw --profile=WinXPSP2x86 --dump-dir=dump_dir
</code></pre><p>dump 出来的进程文件，可以使用 foremost 来分离里面的文件，用 binwak -e 经常会有问题，需要重新修复文件</p>
<p>对当前的窗口界面，生成屏幕截图</p>
<pre><code>volatility screenshot -f file.raw --profile=WinXPSP2x86 --dump-dir=out
</code></pre><h2 id="支持的各种插件"><a href="#支持的各种插件" class="headerlink" title="支持的各种插件"></a>支持的各种插件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br></pre></td><td class="code"><pre><span class="line">Plugins</span><br><span class="line">-------</span><br><span class="line">amcache                    - Print AmCache information</span><br><span class="line">apihooks                   - Detect API hooks in process and kernel memory</span><br><span class="line">atoms                      - Print session and window station atom tables</span><br><span class="line">atomscan                   - Pool scanner for atom tables</span><br><span class="line">auditpol                   - Prints out the Audit Policies from HKLM\SECURITY\Policy\PolAdtEv</span><br><span class="line">bigpools                   - Dump the big page pools using BigPagePoolScanner</span><br><span class="line">bioskbd                    - Reads the keyboard buffer from Real Mode memory</span><br><span class="line">cachedump                  - Dumps cached domain hashes from memory</span><br><span class="line">callbacks                  - Print system-wide notification routines</span><br><span class="line">clipboard                  - Extract the contents of the windows clipboard</span><br><span class="line">cmdline                    - Display process command-line arguments</span><br><span class="line">cmdscan                    - Extract command history by scanning for _COMMAND_HISTORY</span><br><span class="line">connections                - Print list of open connections [Windows XP and 2003 Only]</span><br><span class="line">connscan                   - Pool scanner for tcp connections</span><br><span class="line">consoles                   - Extract command history by scanning for _CONSOLE_INFORMATION</span><br><span class="line">crashinfo                  - Dump crash-dump information</span><br><span class="line">deskscan                   - Poolscaner for tagDESKTOP (desktops)</span><br><span class="line">devicetree                 - Show device tree</span><br><span class="line">dlldump                    - Dump DLLs from a process address space</span><br><span class="line">dlllist                    - Print list of loaded dlls for each process</span><br><span class="line">driverirp                  - Driver IRP hook detection</span><br><span class="line">drivermodule               - Associate driver objects to kernel modules</span><br><span class="line">driverscan                 - Pool scanner for driver objects</span><br><span class="line">dumpcerts                  - Dump RSA private and public SSL keys</span><br><span class="line">dumpfiles                  - Extract memory mapped and cached files</span><br><span class="line">dumpregistry               - Dumps registry files out to disk</span><br><span class="line">editbox                    - Displays information about Edit controls. (Listbox experimental.)</span><br><span class="line">envars                     - Display process environment variables</span><br><span class="line">eventhooks                 - Print details on windows event hooks</span><br><span class="line">evtlogs                    - Extract Windows Event Logs (XP/2003 only)</span><br><span class="line">filescan                   - Pool scanner for file objects</span><br><span class="line">gahti                      - Dump the USER handle type information</span><br><span class="line">gditimers                  - Print installed GDI timers and callbacks</span><br><span class="line">gdt                        - Display Global Descriptor Table</span><br><span class="line">getservicesids             - Get the names of services in the Registry and return Calculated SID</span><br><span class="line">getsids                    - Print the SIDs owning each process</span><br><span class="line">handles                    - Print list of open handles for each process</span><br><span class="line">hashdump                   - Dumps passwords hashes (LM/NTLM) from memory</span><br><span class="line">hibinfo                    - Dump hibernation file information</span><br><span class="line">hivedump                   - Prints out a hive</span><br><span class="line">hivelist                   - Print list of registry hives.</span><br><span class="line">hivescan                   - Pool scanner for registry hives</span><br><span class="line">hpakextract                - Extract physical memory from an HPAK file</span><br><span class="line">hpakinfo                   - Info on an HPAK file</span><br><span class="line">idt                        - Display Interrupt Descriptor Table</span><br><span class="line">iehistory                  - Reconstruct Internet Explorer cache / history</span><br><span class="line">imagecopy                  - Copies a physical address space out as a raw DD image</span><br><span class="line">imageinfo                  - Identify information for the image</span><br><span class="line">impscan                    - Scan for calls to imported functions</span><br><span class="line">joblinks                   - Print process job link information</span><br><span class="line">kdbgscan                   - Search for and dump potential KDBG values</span><br><span class="line">kpcrscan                   - Search for and dump potential KPCR values</span><br><span class="line">ldrmodules                 - Detect unlinked DLLs</span><br><span class="line">limeinfo                   - Dump Lime file format information</span><br><span class="line">linux_apihooks             - Checks for userland apihooks</span><br><span class="line">linux_arp                  - Print the ARP table</span><br><span class="line">linux_aslr_shift           - Automatically detect the Linux ASLR shift</span><br><span class="line">linux_banner               - Prints the Linux banner information</span><br><span class="line">linux_bash                 - Recover bash history from bash process memory</span><br><span class="line">linux_bash_env             - Recover a process&apos; dynamic environment variables</span><br><span class="line">linux_bash_hash            - Recover bash hash table from bash process memory</span><br><span class="line">linux_check_afinfo         - Verifies the operation function pointers of network protocols</span><br><span class="line">linux_check_creds          - Checks if any processes are sharing credential structures</span><br><span class="line">linux_check_evt_arm        - Checks the Exception Vector Table to look for syscall table hooking</span><br><span class="line">linux_check_fop            - Check file operation structures for rootkit modifications</span><br><span class="line">linux_check_idt            - Checks if the IDT has been altered</span><br><span class="line">linux_check_inline_kernel  - Check for inline kernel hooks</span><br><span class="line">linux_check_modules        - Compares module list to sysfs info, if available</span><br><span class="line">linux_check_syscall        - Checks if the system call table has been altered</span><br><span class="line">linux_check_syscall_arm    - Checks if the system call table has been altered</span><br><span class="line">linux_check_tty            - Checks tty devices for hooks</span><br><span class="line">linux_cpuinfo              - Prints info about each active processor</span><br><span class="line">linux_dentry_cache         - Gather files from the dentry cache</span><br><span class="line">linux_dmesg                - Gather dmesg buffer</span><br><span class="line">linux_dump_map             - Writes selected memory mappings to disk</span><br><span class="line">linux_dynamic_env          - Recover a process&apos; dynamic environment variables</span><br><span class="line">linux_elfs                 - Find ELF binaries in process mappings</span><br><span class="line">linux_enumerate_files      - Lists files referenced by the filesystem cache</span><br><span class="line">linux_find_file            - Lists and recovers files from memory</span><br><span class="line">linux_getcwd               - Lists current working directory of each process</span><br><span class="line">linux_hidden_modules       - Carves memory to find hidden kernel modules</span><br><span class="line">linux_ifconfig             - Gathers active interfaces</span><br><span class="line">linux_info_regs            - It&apos;s like &apos;info registers&apos; in GDB. It prints out all the</span><br><span class="line">linux_iomem                - Provides output similar to /proc/iomem</span><br><span class="line">linux_kernel_opened_files  - Lists files that are opened from within the kernel</span><br><span class="line">linux_keyboard_notifiers   - Parses the keyboard notifier call chain</span><br><span class="line">linux_ldrmodules           - Compares the output of proc maps with the list of libraries from libdl</span><br><span class="line">linux_library_list         - Lists libraries loaded into a process</span><br><span class="line">linux_librarydump          - Dumps shared libraries in process memory to disk</span><br><span class="line">linux_list_raw             - List applications with promiscuous sockets</span><br><span class="line">linux_lsmod                - Gather loaded kernel modules</span><br><span class="line">linux_lsof                 - Lists file descriptors and their path</span><br><span class="line">linux_malfind              - Looks for suspicious process mappings</span><br><span class="line">linux_memmap               - Dumps the memory map for linux tasks</span><br><span class="line">linux_moddump              - Extract loaded kernel modules</span><br><span class="line">linux_mount                - Gather mounted fs/devices</span><br><span class="line">linux_mount_cache          - Gather mounted fs/devices from kmem_cache</span><br><span class="line">linux_netfilter            - Lists Netfilter hooks</span><br><span class="line">linux_netscan              - Carves for network connection structures</span><br><span class="line">linux_netstat              - Lists open sockets</span><br><span class="line">linux_pidhashtable         - Enumerates processes through the PID hash table</span><br><span class="line">linux_pkt_queues           - Writes per-process packet queues out to disk</span><br><span class="line">linux_plthook              - Scan ELF binaries&apos; PLT for hooks to non-NEEDED images</span><br><span class="line">linux_proc_maps            - Gathers process memory maps</span><br><span class="line">linux_proc_maps_rb         - Gathers process maps for linux through the mappings red-black tree</span><br><span class="line">linux_procdump             - Dumps a process&apos;s executable image to disk</span><br><span class="line">linux_process_hollow       - Checks for signs of process hollowing</span><br><span class="line">linux_psaux                - Gathers processes along with full command line and start time</span><br><span class="line">linux_psenv                - Gathers processes along with their static environment variables</span><br><span class="line">linux_pslist               - Gather active tasks by walking the task_struct-&gt;task list</span><br><span class="line">linux_pslist_cache         - Gather tasks from the kmem_cache</span><br><span class="line">linux_psscan               - Scan physical memory for processes</span><br><span class="line">linux_pstree               - Shows the parent/child relationship between processes</span><br><span class="line">linux_psxview              - Find hidden processes with various process listings</span><br><span class="line">linux_recover_filesystem   - Recovers the entire cached file system from memory</span><br><span class="line">linux_route_cache          - Recovers the routing cache from memory</span><br><span class="line">linux_sk_buff_cache        - Recovers packets from the sk_buff kmem_cache</span><br><span class="line">linux_slabinfo             - Mimics /proc/slabinfo on a running machine</span><br><span class="line">linux_strings              - Match physical offsets to virtual addresses (may take a while, VERY verbose)</span><br><span class="line">linux_threads              - Prints threads of processes</span><br><span class="line">linux_tmpfs                - Recovers tmpfs filesystems from memory</span><br><span class="line">linux_truecrypt_passphrase - Recovers cached Truecrypt passphrases</span><br><span class="line">linux_vma_cache            - Gather VMAs from the vm_area_struct cache</span><br><span class="line">linux_volshell             - Shell in the memory image</span><br><span class="line">linux_yarascan             - A shell in the Linux memory image</span><br><span class="line">lsadump                    - Dump (decrypted) LSA secrets from the registry</span><br><span class="line">mac_adium                  - Lists Adium messages</span><br><span class="line">mac_apihooks               - Checks for API hooks in processes</span><br><span class="line">mac_apihooks_kernel        - Checks to see if system call and kernel functions are hooked</span><br><span class="line">mac_arp                    - Prints the arp table</span><br><span class="line">mac_bash                   - Recover bash history from bash process memory</span><br><span class="line">mac_bash_env               - Recover bash&apos;s environment variables</span><br><span class="line">mac_bash_hash              - Recover bash hash table from bash process memory</span><br><span class="line">mac_calendar               - Gets calendar events from Calendar.app</span><br><span class="line">mac_check_fop              - Validate File Operation Pointers</span><br><span class="line">mac_check_mig_table        - Lists entires in the kernel&apos;s MIG table</span><br><span class="line">mac_check_syscall_shadow   - Looks for shadow system call tables</span><br><span class="line">mac_check_syscalls         - Checks to see if system call table entries are hooked</span><br><span class="line">mac_check_sysctl           - Checks for unknown sysctl handlers</span><br><span class="line">mac_check_trap_table       - Checks to see if mach trap table entries are hooked</span><br><span class="line">mac_compressed_swap        - Prints Mac OS X VM compressor stats and dumps all compressed pages</span><br><span class="line">mac_contacts               - Gets contact names from Contacts.app</span><br><span class="line">mac_dead_procs             - Prints terminated/de-allocated processes</span><br><span class="line">mac_dead_sockets           - Prints terminated/de-allocated network sockets</span><br><span class="line">mac_dead_vnodes            - Lists freed vnode structures</span><br><span class="line">mac_devfs                  - Lists files in the file cache</span><br><span class="line">mac_dmesg                  - Prints the kernel debug buffer</span><br><span class="line">mac_dump_file              - Dumps a specified file</span><br><span class="line">mac_dump_maps              - Dumps memory ranges of process(es), optionally including pages in compressed swap</span><br><span class="line">mac_dyld_maps              - Gets memory maps of processes from dyld data structures</span><br><span class="line">mac_find_aslr_shift        - Find the ASLR shift value for 10.8+ images</span><br><span class="line">mac_get_profile            - Automatically detect Mac profiles</span><br><span class="line">mac_ifconfig               - Lists network interface information for all devices</span><br><span class="line">mac_interest_handlers      - Lists IOKit Interest Handlers</span><br><span class="line">mac_ip_filters             - Reports any hooked IP filters</span><br><span class="line">mac_kernel_classes         - Lists loaded c++ classes in the kernel</span><br><span class="line">mac_kevents                - Show parent/child relationship of processes</span><br><span class="line">mac_keychaindump           - Recovers possbile keychain keys. Use chainbreaker to open related keychain files</span><br><span class="line">mac_ldrmodules             - Compares the output of proc maps with the list of libraries from libdl</span><br><span class="line">mac_librarydump            - Dumps the executable of a process</span><br><span class="line">mac_list_files             - Lists files in the file cache</span><br><span class="line">mac_list_kauth_listeners   - Lists Kauth Scope listeners</span><br><span class="line">mac_list_kauth_scopes      - Lists Kauth Scopes and their status</span><br><span class="line">mac_list_raw               - List applications with promiscuous sockets</span><br><span class="line">mac_list_sessions          - Enumerates sessions</span><br><span class="line">mac_list_zones             - Prints active zones</span><br><span class="line">mac_lsmod                  - Lists loaded kernel modules</span><br><span class="line">mac_lsmod_iokit            - Lists loaded kernel modules through IOkit</span><br><span class="line">mac_lsmod_kext_map         - Lists loaded kernel modules</span><br><span class="line">mac_lsof                   - Lists per-process opened files</span><br><span class="line">mac_machine_info           - Prints machine information about the sample</span><br><span class="line">mac_malfind                - Looks for suspicious process mappings</span><br><span class="line">mac_memdump                - Dump addressable memory pages to a file</span><br><span class="line">mac_moddump                - Writes the specified kernel extension to disk</span><br><span class="line">mac_mount                  - Prints mounted device information</span><br><span class="line">mac_netstat                - Lists active per-process network connections</span><br><span class="line">mac_network_conns          - Lists network connections from kernel network structures</span><br><span class="line">mac_notesapp               - Finds contents of Notes messages</span><br><span class="line">mac_notifiers              - Detects rootkits that add hooks into I/O Kit (e.g. LogKext)</span><br><span class="line">mac_orphan_threads         - Lists threads that don&apos;t map back to known modules/processes</span><br><span class="line">mac_pgrp_hash_table        - Walks the process group hash table</span><br><span class="line">mac_pid_hash_table         - Walks the pid hash table</span><br><span class="line">mac_print_boot_cmdline     - Prints kernel boot arguments</span><br><span class="line">mac_proc_maps              - Gets memory maps of processes</span><br><span class="line">mac_procdump               - Dumps the executable of a process</span><br><span class="line">mac_psaux                  - Prints processes with arguments in user land (**argv)</span><br><span class="line">mac_psenv                  - Prints processes with environment in user land (**envp)</span><br><span class="line">mac_pslist                 - List Running Processes</span><br><span class="line">mac_pstree                 - Show parent/child relationship of processes</span><br><span class="line">mac_psxview                - Find hidden processes with various process listings</span><br><span class="line">mac_recover_filesystem     - Recover the cached filesystem</span><br><span class="line">mac_route                  - Prints the routing table</span><br><span class="line">mac_socket_filters         - Reports socket filters</span><br><span class="line">mac_strings                - Match physical offsets to virtual addresses (may take a while, VERY verbose)</span><br><span class="line">mac_tasks                  - List Active Tasks</span><br><span class="line">mac_threads                - List Process Threads</span><br><span class="line">mac_threads_simple         - Lists threads along with their start time and priority</span><br><span class="line">mac_timers                 - Reports timers set by kernel drivers</span><br><span class="line">mac_trustedbsd             - Lists malicious trustedbsd policies</span><br><span class="line">mac_version                - Prints the Mac version</span><br><span class="line">mac_vfsevents              - Lists processes filtering file system events</span><br><span class="line">mac_volshell               - Shell in the memory image</span><br><span class="line">mac_yarascan               - Scan memory for yara signatures</span><br><span class="line">machoinfo                  - Dump Mach-O file format information</span><br><span class="line">malfind                    - Find hidden and injected code</span><br><span class="line">mbrparser                  - Scans for and parses potential Master Boot Records (MBRs)</span><br><span class="line">memdump                    - Dump the addressable memory for a process</span><br><span class="line">memmap                     - Print the memory map</span><br><span class="line">messagehooks               - List desktop and thread window message hooks</span><br><span class="line">mftparser                  - Scans for and parses potential MFT entries</span><br><span class="line">moddump                    - Dump a kernel driver to an executable file sample</span><br><span class="line">modscan                    - Pool scanner for kernel modules</span><br><span class="line">modules                    - Print list of loaded modules</span><br><span class="line">multiscan                  - Scan for various objects at once</span><br><span class="line">mutantscan                 - Pool scanner for mutex objects</span><br><span class="line">netscan                    - Scan a Vista (or later) image for connections and sockets</span><br><span class="line">notepad                    - List currently displayed notepad text</span><br><span class="line">objtypescan                - Scan for Windows object type objects</span><br><span class="line">patcher                    - Patches memory based on page scans</span><br><span class="line">poolpeek                   - Configurable pool scanner plugin</span><br><span class="line">pooltracker                - Show a summary of pool tag usage</span><br><span class="line">printkey                   - Print a registry key, and its subkeys and values</span><br><span class="line">privs                      - Display process privileges</span><br><span class="line">procdump                   - Dump a process to an executable file sample</span><br><span class="line">pslist                     - Print all running processes by following the EPROCESS lists</span><br><span class="line">psscan                     - Pool scanner for process objects</span><br><span class="line">pstree                     - Print process list as a tree</span><br><span class="line">psxview                    - Find hidden processes with various process listings</span><br><span class="line">qemuinfo                   - Dump Qemu information</span><br><span class="line">raw2dmp                    - Converts a physical memory sample to a windbg crash dump</span><br><span class="line">screenshot                 - Save a pseudo-screenshot based on GDI windows</span><br><span class="line">servicediff                - List Windows services (ala Plugx)</span><br><span class="line">sessions                   - List details on _MM_SESSION_SPACE (user logon sessions)</span><br><span class="line">shellbags                  - Prints ShellBags info</span><br><span class="line">shimcache                  - Parses the Application Compatibility Shim Cache registry key</span><br><span class="line">shutdowntime               - Print ShutdownTime of machine from registry</span><br><span class="line">sockets                    - Print list of open sockets</span><br><span class="line">sockscan                   - Pool scanner for tcp socket objects</span><br><span class="line">ssdt                       - Display SSDT entries</span><br><span class="line">strings                    - Match physical offsets to virtual addresses (may take a while, VERY verbose)</span><br><span class="line">svcscan                    - Scan for Windows services</span><br><span class="line">symlinkscan                - Pool scanner for symlink objects</span><br><span class="line">thrdscan                   - Pool scanner for thread objects</span><br><span class="line">threads                    - Investigate _ETHREAD and _KTHREADs</span><br><span class="line">timeliner                  - Creates a timeline from various artifacts in memory</span><br><span class="line">timers                     - Print kernel timers and associated module DPCs</span><br><span class="line">truecryptmaster            - Recover TrueCrypt 7.1a Master Keys</span><br><span class="line">truecryptpassphrase        - TrueCrypt Cached Passphrase Finder</span><br><span class="line">truecryptsummary           - TrueCrypt Summary</span><br><span class="line">unloadedmodules            - Print list of unloaded modules</span><br><span class="line">userassist                 - Print userassist registry keys and information</span><br><span class="line">userhandles                - Dump the USER handle tables</span><br><span class="line">vaddump                    - Dumps out the vad sections to a file</span><br><span class="line">vadinfo                    - Dump the VAD info</span><br><span class="line">vadtree                    - Walk the VAD tree and display in tree format</span><br><span class="line">vadwalk                    - Walk the VAD tree</span><br><span class="line">vboxinfo                   - Dump virtualbox information</span><br><span class="line">verinfo                    - Prints out the version information from PE images</span><br><span class="line">vmwareinfo                 - Dump VMware VMSS/VMSN information</span><br><span class="line">volshell                   - Shell in the memory image</span><br><span class="line">win10cookie                - Find the ObHeaderCookie value for Windows 10</span><br><span class="line">windows                    - Print Desktop Windows (verbose details)</span><br><span class="line">wintree                    - Print Z-Order Desktop Windows Tree</span><br><span class="line">wndscan                    - Pool scanner for window stations</span><br><span class="line">yarascan                   - Scan process or kernel memory with Yara signatures</span><br></pre></td></tr></table></figure>
</span>
      
    </div>

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CTF/" rel="tag">#CTF</a>
          
            <a href="/tags/取证分析/" rel="tag">#取证分析</a>
          
            <a href="/tags/内存取证/" rel="tag">#内存取证</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/08/10/crypto-analyze-tool-feather-duster/" rel="prev">密码学分析和破解工具 FeatherDuster 使用说明</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/09/frontend-develop-and-http-optimization-history/" rel="next">HTTP 协议与前端开发的性能优化史</a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>
  


    <div class="post-spread">
      
    </div>
    
  </div>

 
        </div>

        
          
            <div class="comments" id="comments">
              
                <div id="disqus_thread">
                  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                </div>
              
            </div>
          
        
      </div>
      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/uploads/avatar.jpg" alt="restran" itemprop="image"/>
          <p class="site-author-name" itemprop="name">restran</p>
        </div>
        <p class="site-description motion-element" itemprop="description">在位流的海洋里徜徉～</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">63</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">17</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">62</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="menu-item-icon icon-next-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/restran" target="_blank">Github</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/restran" target="_blank">Weibo</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://douban.com/people/restran" target="_blank">Douban</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/restran" target="_blank">Zhihu</a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">Links</p>
            
              <span class="links-of-author-item">
              <a href="http://blog.itpub.net/22664653/" target="_blank">北在南方</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://qzcool.com/" target="_blank">fredliu</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://linyuhao.cc/" target="_blank">依依呀呀</a>
              </span>
            
          
        </div>

      </section>

      
        <section class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#常见的插件"><span class="nav-number">1.</span> <span class="nav-text">常见的插件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#支持的各种插件"><span class="nav-number">2.</span> <span class="nav-text">支持的各种插件</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </section>
      

    </div>
  </aside>


      
    </main>

    
    
    
        <footer id="footer" class="footer">
          <div class="footer-inner"> <div class="copyright" >
  
  &copy;&nbsp; 2014 - 
  <span itemprop="copyrightYear">2018</span>
  by
  <span class="author" itemprop="copyrightHolder">restran, </span>
</div>

  <span>thanks to <a class="theme-link" href="http://hexo.io">Hexo</a> and   
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT Mist. 
  </a>
  </span>

  <span>Hosted by <a href="https://pages.coding.me">Coding Pages</a></span>


 </div>
        </footer>
    
    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn",
        load: function (element_left) {
          // 图片加载后，修改 img 的父节点 a 的 href
          // 确保 fancybox 上面的图片显示正确
          var node = $(this);
          node.parent().attr('href', node.attr('data-original'));
        }
      });
    });
  </script>
  

  

  
  
<script type="text/javascript">
    (function() {
        var items = $('figure.highlight');
        for (var i = 0; i < items.length; i++) {
            var item = items[i];
            var node = $(item);
            var className = node.attr('class');
            var classList = className.split(' ');
            var langName = '';
            if (classList.length > 1) {
                langName = classList[1];
            }
            node.attr('data-lang', langName);
        };
    })();
</script>



  
  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>



  
    <script type="text/javascript">
  $(".reward-wrapper .reward-btn").fancybox({
      maxWidth: 650,
      maxHeight: 350,
      fitToView: true,
      autoSize: true,
      closeClick: false,
      openEffect: 'none',
      closeEffect: 'none',
      helpers: {
        title: {
            type: 'inside'
        },
        overlay: {
            locked: false
        }
      }
  });

  $("[data-track]").on("click", function() {
      var label = $(this).data("track");
      window._hmt && window._hmt.push(['_trackEvent', label, 'click']);
  });
</script>
  

  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>





  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.1" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" src="/js/post-detail.js"></script>



  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>



  
    <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("QnkkLfx3yvVKY4LTTTJBjDqW-gzGzoHsz", "FVfLCd14uEKbS1GXLxKWJS7O");</script>
<script type="text/javascript" src="/js/lean-analytics.js"></script>
  
  
  
    
  
    <script type="text/javascript">
      // 本地测试屏蔽评论
      var host = window.location.host;
      var disqus_shortname = host.includes('127.0.0.1') || host.includes('0.0.0.0') || host.includes('localhost') ? 'restranDev' : 'restran';
      // var disqus_shortname = 'restran';
      var disqus_identifier = '2017/08/10/memory-forensics-tool-volatility/';
      var disqus_title = '内存取证工具 volatility 使用说明';
      var disqus_url = 'http://www.restran.net/2017/08/10/memory-forensics-tool-volatility/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  


  

  
</body>
</html>
