{"version":3,"sources":["main.js"],"names":["window","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","FRAME_RATE","PARTICLE_NUM","RADIUS","Math","PI","CANVAS_WIDTH","CANVAS_HEIGHT","CANVAS_ID","SCREEN_HEIGHT","screen","height","SCREEN_WIDTH","width","texts","canvas","ctx","particles","quiver","text","textIndex","textSize","init","tmpTexts","getUrlParam","split","console","log","e","document","getElementById","getContext","setDimensions","event","i","Particle","draw","setInterval","length","clearRect","fillStyle","textBaseline","fontWeight","font","fillText","measureText","imgData","getImageData","l","p","inText","particleText","pxls","w","h","index","data","push","count","j","parseInt","X","Y","px","random","py","T","sqrt","A","atan2","C","cos","S","sin","x","delta","y","fadeIn","fadeOut","mx","my","name","default_value","reg","RegExp","url","location","search","substr","decodeURI","r","match","unescape","style","position","left","top","bottom","right","marginTop","innerHeight","addEventListener","spread","size","opacity","fadeInRate","fadeOutRate","opacityTresh","fadingOut","fadingIn","beginPath","arc","closePath","fill","setTimeout"],"mappings":"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","file":"main.js","sourcesContent":[";(function (window) {\n  window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||\n    window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;\n\n  const FRAME_RATE = 60;\n  const PARTICLE_NUM = 2000;\n  const RADIUS = Math.PI * 2;\n  let CANVAS_WIDTH = 320;\n  let CANVAS_HEIGHT = 300;\n  const CANVAS_ID = 'canvas';\n  const SCREEN_HEIGHT = window.screen.height;\n  const SCREEN_WIDTH = window.screen.width;\n\n  let texts = ['新年快乐', '大吉大利', '天天开心', 'Always'];\n\n  let canvas,\n    ctx,\n    particles = [],\n    quiver = true,\n    text = texts[0],\n    textIndex = 0,\n    textSize = 62;\n\n  function init() {\n    if (SCREEN_WIDTH <= 320) {\n      CANVAS_WIDTH = 320;\n      CANVAS_HEIGHT = 250;\n      textSize = 62;\n    } else if (SCREEN_WIDTH <= 400) {\n      CANVAS_WIDTH = 350;\n      CANVAS_HEIGHT = 300;\n      textSize = 65;\n    } else {\n      CANVAS_WIDTH = 400;\n      CANVAS_HEIGHT = 300;\n      textSize = 72;\n    }\n\n    // 从 url 中读取参数\n    let tmpTexts = getUrlParam('texts', null);\n    try {\n      texts = tmpTexts.split(',');\n      text = texts[0];\n      textIndex = 0;\n      console.log(tmpTexts);\n    } catch (e) {\n\n    }\n    canvas = document.getElementById(CANVAS_ID);\n    if (canvas === null || !canvas.getContext) {\n      return\n    }\n    ctx = canvas.getContext('2d');\n    setDimensions();\n    event();\n\n    for (var i = 0; i < PARTICLE_NUM; i++) {\n      particles[i] = new Particle(canvas);\n    }\n\n    draw();\n\n    setInterval(function () {\n      textIndex++;\n      textIndex = textIndex % texts.length;\n      text = texts[textIndex];\n      console.log(textIndex);\n    }, 4500);\n  }\n\n  function draw() {\n    ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n    ctx.fillStyle = 'rgb(255, 255, 255)';\n    ctx.textBaseline = 'middle';\n    ctx.fontWeight = 'bold';\n    ctx.font = textSize + 'px \\'SimHei\\', \\'Avenir\\', \\'Helvetica Neue\\', \\'Arial\\', \\'sans-serif\\'';\n    ctx.fillText(text, (CANVAS_WIDTH - ctx.measureText(text).width) * 0.5, CANVAS_HEIGHT * 0.5);\n\n    let imgData = ctx.getImageData(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n\n    ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n\n    for (let i = 0, l = particles.length; i < l; i++) {\n      let p = particles[i];\n      p.inText = false\n    }\n    particleText(imgData);\n\n    window.requestAnimationFrame(draw)\n  }\n\n  function particleText(imgData) {\n    // 点坐标获取\n    var pxls = [];\n    for (var w = CANVAS_WIDTH; w > 0; w -= 3) {\n      for (var h = 0; h < CANVAS_HEIGHT; h += 3) {\n        var index = (w + h * (CANVAS_WIDTH)) * 4;\n        if (imgData.data[index] > 1) {\n          pxls.push([w, h])\n        }\n      }\n    }\n\n    var count = pxls.length;\n    var j = parseInt((particles.length - pxls.length) / 2, 10);\n    j = j < 0 ? 0 : j;\n\n    for (var i = 0; i < pxls.length && j < particles.length; i++, j++) {\n      try {\n        var p = particles[j],\n          X,\n          Y;\n\n        if (quiver) {\n          X = (pxls[i - 1][0]) - (p.px + Math.random() * 10);\n          Y = (pxls[i - 1][1]) - (p.py + Math.random() * 10)\n        } else {\n          X = (pxls[i - 1][0]) - p.px;\n          Y = (pxls[i - 1][1]) - p.py\n        }\n        var T = Math.sqrt(X * X + Y * Y);\n        var A = Math.atan2(Y, X);\n        var C = Math.cos(A);\n        var S = Math.sin(A);\n        p.x = p.px + C * T * p.delta;\n        p.y = p.py + S * T * p.delta;\n        p.px = p.x;\n        p.py = p.y;\n        p.inText = true;\n        p.fadeIn();\n        p.draw(ctx)\n      } catch (e) {\n      }\n    }\n    for (var i = 0; i < particles.length; i++) {\n      var p = particles[i];\n      if (!p.inText) {\n        p.fadeOut();\n\n        var X = p.mx - p.px;\n        var Y = p.my - p.py;\n        var T = Math.sqrt(X * X + Y * Y);\n        var A = Math.atan2(Y, X);\n        var C = Math.cos(A);\n        var S = Math.sin(A);\n\n        p.x = p.px + C * T * p.delta / 2;\n        p.y = p.py + S * T * p.delta / 2;\n        p.px = p.x;\n        p.py = p.y;\n\n        p.draw(ctx)\n      }\n    }\n  }\n\n  function getUrlParam(name, default_value) {\n    //构造一个含有目标参数的正则表达式对象\n    let reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)');\n    // decodeURI，处理中文问题\n    let url = window.location.search.substr(1);\n    console.log(url);\n    try {\n      url = decodeURI(url);\n    } catch (e) {\n    }\n    let r = url.match(reg);  //匹配目标参数\n    if (r != null) return unescape(r[2]);\n    return default_value; //返回参数值\n  }\n\n  function setDimensions() {\n    canvas.width = CANVAS_WIDTH;\n    canvas.height = CANVAS_HEIGHT;\n    canvas.style.position = 'absolute';\n    canvas.style.left = '0px';\n    canvas.style.top = '0px';\n    canvas.style.bottom = '0px';\n    canvas.style.right = '0px';\n    canvas.style.marginTop = window.innerHeight * .15 + 'px';\n  }\n\n  function event() {\n    document.addEventListener('click', function (e) {\n      textIndex++;\n      textIndex = textIndex % texts.length;\n      // if (textIndex >= texts.length) {\n      //   textIndex--;\n      //   return\n      // }\n      text = texts[textIndex];\n      console.log(textIndex);\n    }, false);\n\n    // document.addEventListener('touchstart', function (e) {\n    //   textIndex++;\n    //   textIndex = textIndex % texts.length;\n    //   // if (textIndex >= texts.length) {\n    //   //   textIndex--;\n    //   //   return\n    //   // }\n    //   text = texts[textIndex];\n    //   console.log(textIndex)\n    // }, false)\n  }\n\n  class Particle {\n    constructor(canvas) {\n      let spread = canvas.height;\n      let size = Math.random() * 1.2;\n      // 速度\n      this.delta = 0.06;\n      // 现在的位置\n      this.x = 0;\n      this.y = 0;\n      // 上次的位置\n      this.px = Math.random() * canvas.width;\n      this.py = (canvas.height * 0.5) + ((Math.random() - 0.5) * spread);\n      // 记录点最初的位置\n      this.mx = this.px;\n      this.my = this.py;\n      // 点的大小\n      this.size = size;\n      // this.origSize = size\n      // 是否用来显示字\n      this.inText = false;\n      // 透明度相关\n      this.opacity = 0;\n      this.fadeInRate = 0.005;\n      this.fadeOutRate = 0.03;\n      this.opacityTresh = 0.98;\n      this.fadingOut = true;\n      this.fadingIn = true;\n    }\n\n    fadeIn() {\n      this.fadingIn = this.opacity <= this.opacityTresh;\n      if (this.fadingIn) {\n        this.opacity += this.fadeInRate\n      } else {\n        this.opacity = 1\n      }\n    }\n\n    fadeOut() {\n      this.fadingOut = this.opacity >= 0;\n      if (this.fadingOut) {\n        this.opacity -= this.fadeOutRate;\n        if (this.opacity < 0) {\n          this.opacity = 0\n        }\n      } else {\n        this.opacity = 0\n      }\n    }\n\n    draw(ctx) {\n      ctx.fillStyle = 'rgba(226,225,142, ' + this.opacity + ')';\n      ctx.beginPath();\n      ctx.arc(this.x, this.y, this.size, 0, RADIUS, true);\n      ctx.closePath();\n      ctx.fill()\n    }\n  }\n\n  setTimeout(() => {\n    init();\n  }, 1000);\n  // mp3.play()\n})(window);\n"]}